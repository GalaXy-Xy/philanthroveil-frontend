(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[801],{7441:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),l=s(2115),n=s(2800),r=s(2619),c=s.n(r);function o(e){let{params:t}=e,{id:s}=(0,l.use)(t),{contract:r,donate:o,decryptTotalDonations:i,getLeaderboard:d,isLoading:m}=(0,n.L)(),[x,b]=(0,l.useState)(null),[u,h]=(0,l.useState)(!0),[p,j]=(0,l.useState)(""),[N,g]=(0,l.useState)(!1),[f,y]=(0,l.useState)(!1),[v,D]=(0,l.useState)(null),[w,k]=(0,l.useState)([]),[P,C]=(0,l.useState)(!1),[T,A]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{if(!r)return h(!1);try{let e=await r.getProject(Number(s));b({name:e[0],description:e[1],goal:e[2],imageUrl:e[3],creator:e[4],donorCount:Number(e[5]),isActive:e[7],createdAt:Number(e[8])})}catch(e){console.error("Failed to load project:",e),A("Failed to load project details")}finally{h(!1)}})()},[r,s]);let S=async()=>{if(!p||0>=parseFloat(p))return void A("Please enter a valid donation amount");g(!0),A("");try{await o(Number(s),p);let e=await r.getProject(Number(s));b({name:e[0],description:e[1],goal:e[2],imageUrl:e[3],creator:e[4],donorCount:Number(e[5]),isActive:e[6],createdAt:Number(e[7])}),j(""),alert("✅ Donation successful! Your contribution has been encrypted on-chain.")}catch(e){console.error("Donation failed:",e),A(e.message||"Donation failed. Please try again.")}finally{g(!1)}},E=async()=>{y(!0),A("");try{let e=await i(Number(s));D(e)}catch(e){console.error("Decryption failed:",e),A(e.message||"Failed to decrypt total donations")}finally{y(!1)}},F=async()=>{C(!0),A("");try{let e=await d(Number(s),10);k(e)}catch(e){console.error("Failed to load leaderboard:",e),A(e.message||"Failed to load leaderboard")}finally{C(!1)}};return u||m?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading project..."})]})}):x?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(c(),{href:"/projects",className:"text-blue-600 hover:text-blue-700 mb-6 inline-flex items-center",children:"← Back to Projects"}),(0,a.jsx)("h1",{className:"text-4xl font-bold mb-2 text-slate-900",children:x.name}),(0,a.jsxs)("p",{className:"text-slate-500 mb-8",children:["Created on ",new Date(1e3*x.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),(0,a.jsxs)("div",{className:"glass-card p-8 mb-6",children:[x.imageUrl&&(0,a.jsx)("div",{className:"mb-6 h-64 rounded-lg overflow-hidden bg-slate-200",children:(0,a.jsx)("img",{src:x.imageUrl,alt:x.name,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none"}})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-slate-900",children:"About This Project"}),(0,a.jsx)("p",{className:"text-slate-600 mb-6 whitespace-pre-wrap",children:x.description}),x.goal&&(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900 mb-2",children:"Project Goal"}),(0,a.jsx)("p",{className:"text-slate-700",children:x.goal})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-slate-100 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-600 mb-1",children:"Total Donors"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:x.donorCount})]}),(0,a.jsxs)("div",{className:"bg-slate-100 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-600 mb-1",children:"Status"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:x.isActive?(0,a.jsx)("span",{className:"text-green-600",children:"● Active"}):(0,a.jsx)("span",{className:"text-red-600",children:"● Closed"})})]}),(0,a.jsxs)("div",{className:"col-span-2 bg-slate-100 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-600 mb-2",children:"Total Donations (Encrypted)"}),v?(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[v," ETH"]}):(0,a.jsx)("button",{onClick:E,disabled:f,className:"btn-outline text-sm px-4 py-2",children:f?"Decrypting...":"\uD83D\uDD13 Decrypt Total"})]})]})]}),(0,a.jsxs)("div",{className:"glass-card p-8 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Anonymous Leaderboard"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Top donors ranked by encrypted contributions (amounts hidden)"})]}),0===w.length&&(0,a.jsx)("button",{onClick:F,disabled:P,className:"btn-outline px-6 py-2",children:P?"Loading...":"\uD83C\uDFC6 Load Leaderboard"})]}),w.length>0?(0,a.jsx)("div",{className:"space-y-3",children:w.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"\n                        w-10 h-10 rounded-full flex items-center justify-center font-bold text-white\n                        ".concat(1===e.rank?"bg-yellow-500":"","\n                        ").concat(2===e.rank?"bg-gray-400":"","\n                        ").concat(3===e.rank?"bg-amber-700":"","\n                        ").concat(e.rank>3?"bg-blue-500":"","\n                      "),children:["#",e.rank]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"font-mono text-sm font-semibold text-slate-900",children:[e.donor.slice(0,6),"...",e.donor.slice(-4)]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[1===e.rank&&"\uD83E\uDD47 Top Donor",2===e.rank&&"\uD83E\uDD48 2nd Place",3===e.rank&&"\uD83E\uDD49 3rd Place",e.rank>3&&"Top ".concat(e.rank)]})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"text-2xl",children:"\uD83D\uDD12"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Amount Hidden"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Privacy Protected"})]})]})})]},e.rank))}):(0,a.jsxs)("div",{className:"text-center py-12 bg-slate-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFC6"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4",children:0===x.donorCount?"No donations yet. Be the first!":"Click the button above to decrypt and view the leaderboard"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg max-w-md mx-auto mt-4",children:(0,a.jsxs)("p",{className:"text-sm text-slate-700",children:[(0,a.jsx)("strong",{children:"\uD83D\uDD10 Privacy Notice:"})," The leaderboard shows donor addresses and rankings, but ",(0,a.jsx)("strong",{children:"donation amounts remain encrypted"}),". This allows verification of participation while protecting financial privacy."]})})]})]}),x.isActive?(0,a.jsxs)("div",{className:"glass-card p-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-slate-900",children:"Make a Donation"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-slate-900",children:"Amount (ETH)"}),(0,a.jsx)("input",{type:"number",step:"0.001",value:p,onChange:e=>j(e.target.value),className:"w-full px-4 py-3 rounded-md bg-white border border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition",placeholder:"0.001",disabled:N})]}),T&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:T}),(0,a.jsx)("button",{onClick:S,disabled:N||!p,className:"btn-primary w-full py-4 text-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Processing...":"\uD83D\uDD12 Donate Anonymously"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-slate-700",children:[(0,a.jsx)("strong",{children:"\uD83D\uDD10 Privacy Notice:"})," Your donation amount will be fully encrypted on-chain. Only you can decrypt your contribution amount. The project creator can see the total donations but not individual amounts or donor identities."]})})]})]}):(0,a.jsxs)("div",{className:"glass-card p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD12"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Project Closed"}),(0,a.jsx)("p",{className:"text-slate-600",children:"This project is no longer accepting donations."})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"glass-card p-12 text-center max-w-md",children:[(0,a.jsx)("div",{className:"text-6xl mb-6",children:"❌"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Project Not Found"}),(0,a.jsx)("p",{className:"text-slate-600 mb-8",children:"The project you're looking for doesn't exist or hasn't been created yet."}),(0,a.jsx)(c(),{href:"/projects",className:"btn-primary px-8 py-3 inline-block",children:"← Back to Projects"})]})})}},8660:(e,t,s)=>{Promise.resolve().then(s.bind(s,7441))}},e=>{e.O(0,[619,830,800,441,255,358],()=>e(e.s=8660)),_N_E=e.O()}]);